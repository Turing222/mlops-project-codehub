{"timestamp": "2026-01-27T00:32:53.329442", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'AsyncSession' object has no attribute 'exec'", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 140, in user_register\n    if await self.repo.get_by_email(email=user_in.email):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/user_repo.py\", line 17, in get_by_email\n    result = await self.session.exec(statement)\n                   ^^^^^^^^^^^^^^^^^\nAttributeError: 'AsyncSession' object has no attribute 'exec'"}
{"timestamp": "2026-01-27T00:35:03.462123", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'password' is an invalid keyword argument for User", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 148, in user_register\n    user = await self.repo.create(obj_in=user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/base.py\", line 84, in create\n    db_obj = self.model(**create_data)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 596, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 594, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'password' is an invalid keyword argument for User"}
{"timestamp": "2026-01-27T00:43:25.137265", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'password' is an invalid keyword argument for User", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 152, in user_register\n    user = await self.repo.create(obj_in=user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/base.py\", line 84, in create\n    db_obj = self.model(**create_data)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 596, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 594, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'password' is an invalid keyword argument for User"}
{"timestamp": "2026-01-27T00:44:19.551752", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'confirm_password' is an invalid keyword argument for User", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 152, in user_register\n    user = await self.repo.create(obj_in=obj_in_data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/base.py\", line 84, in create\n    db_obj = self.model(**create_data)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 4, in __init__\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 596, in _initialize_instance\n    with util.safe_reraise():\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py\", line 594, in _initialize_instance\n    manager.original_init(*mixed[1:], **kwargs)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py\", line 2179, in _declarative_constructor\n    raise TypeError(\nTypeError: 'confirm_password' is an invalid keyword argument for User"}
{"timestamp": "2026-01-27T00:45:34.412484", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: <coroutine object get_password_hash at 0... (expected str, got coroutine)\n[SQL: INSERT INTO users (username, email, is_active, is_superuser, hashed_password, id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::BOOLEAN, $4::BOOLEAN, $5::VARCHAR, $6::UUID) RETURNING users.created_at, users.updated_at]\n[parameters: ('9lnfsemunygjwjakdajj', 'user@example.com', True, False, <coroutine object get_password_hash at 0x729c8bc6af60>, UUID('019bfb32-453b-23ac-103c-e7c49e284ceb'))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 251, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got coroutine\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 177, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 268, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 257, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 184, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $5: <coroutine object get_password_hash at 0... (expected str, got coroutine)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: <coroutine object get_password_hash at 0... (expected str, got coroutine)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 154, in user_register\n    user = await self.repo.create(obj_in=obj_in_data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/base.py\", line 88, in create\n    await self.session.flush()  # flush 获取 ID，但不提交事务\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 787, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4331, in flush\n    self._flush(objects)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4466, in _flush\n    with util.safe_reraise():\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4427, in _flush\n    flush_context.execute()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 527, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2363, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $5: <coroutine object get_password_hash at 0... (expected str, got coroutine)\n[SQL: INSERT INTO users (username, email, is_active, is_superuser, hashed_password, id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::BOOLEAN, $4::BOOLEAN, $5::VARCHAR, $6::UUID) RETURNING users.created_at, users.updated_at]\n[parameters: ('9lnfsemunygjwjakdajj', 'user@example.com', True, False, <coroutine object get_password_hash at 0x729c8bc6af60>, UUID('019bfb32-453b-23ac-103c-e7c49e284ceb'))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"timestamp": "2026-01-27T00:47:58.987482", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 148, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T00:53:29.162652", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'AsyncSession' object has no attribute 'exec'", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 140, in user_register\n    if await self.repo.get_by_email(email=user_in.email):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/user_repo.py\", line 17, in get_by_email\n    result = await self.session.exec(statement)\n                   ^^^^^^^^^^^^^^^^^\nAttributeError: 'AsyncSession' object has no attribute 'exec'"}
{"timestamp": "2026-01-27T00:56:17.224504", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - 'AsyncSession' object has no attribute 'exec'", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 140, in user_register\n    if await self.repo.get_by_email(email=user_in.email):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/repositories/user_repo.py\", line 17, in get_by_email\n    result = await self.session.exec(statement)\n                   ^^^^^^^^^^^^^^^^^\nAttributeError: 'AsyncSession' object has no attribute 'exec'"}
{"timestamp": "2026-01-27T00:56:31.849921", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 148, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T00:57:52.515326", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 149, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T00:59:13.764285", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 149, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T01:01:24.069868", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 150, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T01:04:05.310017", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 150, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T01:06:30.222425", "level": "ERROR", "message": "全局异常捕获: POST http://127.0.0.1:8000/api/v1/auth/register - password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/auth.py\", line 22, in register\n    user = await service.user_register(user_in)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 150, in user_register\n    obj_in_data[\"hashed_password\"] = await get_password_hash(\n                                     ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/core/security.py\", line 23, in get_password_hash\n    return await run_in_threadpool(pwd_context.hash, password)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/concurrency.py\", line 32, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/to_thread.py\", line 61, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2525, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 986, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/context.py\", line 2258, in hash\n    return record.hash(secret, **kwds)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 779, in hash\n    self.checksum = self._calc_checksum(secret)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 591, in _calc_checksum\n    self._stub_requires_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2254, in _stub_requires_backend\n    cls.set_backend()\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2156, in set_backend\n    return owner.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2163, in set_backend\n    return cls.set_backend(name, dryrun=dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2188, in set_backend\n    cls._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2311, in _set_backend\n    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 2224, in _set_backend\n    ok = loader(**kwds)\n         ^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 626, in _load_backend_mixin\n    return mixin_cls._finalize_backend_mixin(name, dryrun)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 421, in _finalize_backend_mixin\n    if detect_wrap_bug(IDENT_2A):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 380, in detect_wrap_bug\n    if verify(secret, bug_hash):\n       ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/utils/handlers.py\", line 792, in verify\n    return consteq(self._calc_checksum(secret), chk)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 655, in _calc_checksum\n    hash = _bcrypt.hashpw(secret, config)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"timestamp": "2026-01-27T01:10:09.121550", "level": "ERROR", "message": "全局异常捕获: GET http://127.0.0.1:8000/api/v1/users?email=user%40example.com - 'str' object has no attribute 'email'", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 428, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 314, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/user.py\", line 33, in read_user\n    user = await service.get_by_email(search_params.email)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/app/services/user_service.py\", line 128, in get_by_email\n    return await self.repo.get_by_email(email=user_in.email)\n                                              ^^^^^^^^^^^^^\nAttributeError: 'str' object has no attribute 'email'"}
{"timestamp": "2026-01-27T01:16:21.614879", "level": "ERROR", "message": "全局异常捕获: GET http://127.0.0.1:8000/api/v1/users?email=user%40example.com - 7 validation errors:\n  {'type': 'missing', 'loc': ('response', 'username'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'email'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'is_active'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'is_superuser'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/user.py\", line 20, in read_user\n    GET /api/v1/users", "logger": "app.core.exceptions", "module": "exceptions", "func_name": "global_exception_handler", "line_no": 44, "exception": "Traceback (most recent call last):\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 118, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 104, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 450, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/tongying/workspace/mlops-project/.venv/lib/python3.11/site-packages/fastapi/routing.py\", line 276, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 7 validation errors:\n  {'type': 'missing', 'loc': ('response', 'username'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'email'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'is_active'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'is_superuser'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': (<app.models.orm.user.User object at 0x78dde28cb6d0>,)}\n\n  File \"/home/tongying/workspace/mlops-project/app/api/v1/endpoint/user.py\", line 20, in read_user\n    GET /api/v1/users"}
